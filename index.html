<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="description" content="A fun and colorful app for kids to learn the alphabet! Tap any letter to hear its name.">
<meta name="theme-color" content="#2D1B69">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="ABC Fun">

<title>ABC Fun - Learn Your Letters!</title>

<!-- PWA Manifest -->
<link rel="manifest" href="manifest.json">

<!-- Icons -->
<link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192x192.png">
<link rel="apple-touch-icon" href="icons/icon-192x192.png">

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;800&family=Nunito:wght@700;900&display=swap" rel="stylesheet">

<style>
  :root {
    --bg: #FFF8E7;
    --text: #2D1B69;
    --shadow: rgba(45, 27, 105, 0.15);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

  body {
    font-family: 'Baloo 2', cursive;
    background: var(--bg);
    min-height: 100vh;
    overflow-x: hidden;
    user-select: none;
    -webkit-user-select: none;
    padding-bottom: 70px;
  }

  /* Floating background shapes */
  .bg-shapes {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 0;
    overflow: hidden;
  }

  .bg-shapes span {
    position: absolute;
    border-radius: 50%;
    opacity: 0.08;
    animation: floaty 20s infinite ease-in-out;
  }

  .bg-shapes span:nth-child(1) { width: 300px; height: 300px; background: #FF6B6B; top: -50px; left: -80px; animation-delay: 0s; }
  .bg-shapes span:nth-child(2) { width: 200px; height: 200px; background: #4ECDC4; top: 20%; right: -40px; animation-delay: -5s; }
  .bg-shapes span:nth-child(3) { width: 250px; height: 250px; background: #FFE66D; bottom: 10%; left: 10%; animation-delay: -10s; }
  .bg-shapes span:nth-child(4) { width: 180px; height: 180px; background: #A78BFA; bottom: -30px; right: 20%; animation-delay: -15s; }
  .bg-shapes span:nth-child(5) { width: 150px; height: 150px; background: #F97316; top: 50%; left: 50%; animation-delay: -7s; }

  @keyframes floaty {
    0%, 100% { transform: translate(0, 0) scale(1); }
    25% { transform: translate(30px, -20px) scale(1.05); }
    50% { transform: translate(-20px, 30px) scale(0.95); }
    75% { transform: translate(20px, 20px) scale(1.02); }
  }

  /* Header */
  header {
    position: relative;
    z-index: 2;
    text-align: center;
    padding: 28px 20px 10px;
  }

  header h1 {
    font-family: 'Nunito', sans-serif;
    font-weight: 900;
    font-size: clamp(2rem, 6vw, 3.2rem);
    color: var(--text);
    letter-spacing: -1px;
    line-height: 1.1;
  }

  header h1 .rainbow {
    background: linear-gradient(90deg, #FF6B6B, #FFE66D, #4ECDC4, #A78BFA, #FF6B6B);
    background-size: 200% auto;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: shimmer 4s linear infinite;
  }

  @keyframes shimmer {
    to { background-position: 200% center; }
  }

  header p {
    font-size: clamp(0.9rem, 2.5vw, 1.15rem);
    color: #8B7FB8;
    margin-top: 4px;
    font-weight: 600;
  }

  /* Letter Grid */
  .grid-container {
    position: relative;
    z-index: 2;
    max-width: 720px;
    margin: 16px auto 40px;
    padding: 0 16px;
  }

  .letter-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(72px, 1fr));
    gap: 12px;
    justify-items: center;
  }

  @media (min-width: 500px) {
    .letter-grid { grid-template-columns: repeat(6, 1fr); gap: 14px; }
  }

  @media (min-width: 700px) {
    .letter-grid { grid-template-columns: repeat(7, 1fr); gap: 16px; }
  }

  /* Individual Letter Tile */
  .letter-tile {
    --hue: 0;
    width: 100%;
    aspect-ratio: 1;
    max-width: 95px;
    border: none;
    border-radius: 22px;
    background: hsl(var(--hue), 75%, 96%);
    color: hsl(var(--hue), 70%, 45%);
    font-family: 'Nunito', sans-serif;
    font-weight: 900;
    font-size: clamp(1.8rem, 5vw, 2.6rem);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    transition: transform 0.15s cubic-bezier(.34,1.56,.64,1), box-shadow 0.15s ease;
    box-shadow:
      0 4px 0 hsl(var(--hue), 60%, 82%),
      0 6px 16px var(--shadow);
    outline: none;
    -webkit-tap-highlight-color: transparent;
    animation: tileEnter 0.4s ease-out both;
  }

  .letter-tile:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow:
      0 7px 0 hsl(var(--hue), 60%, 78%),
      0 10px 24px var(--shadow);
  }

  .letter-tile:active,
  .letter-tile.pressed {
    transform: translateY(2px) scale(0.96);
    box-shadow:
      0 1px 0 hsl(var(--hue), 60%, 85%),
      0 2px 8px var(--shadow);
  }

  .letter-tile.pop {
    animation: popBounce 0.5s cubic-bezier(.34,1.56,.64,1);
  }

  @keyframes tileEnter {
    from { opacity: 0; transform: translateY(20px) scale(0.8); }
    to   { opacity: 1; transform: translateY(0) scale(1); }
  }

  @keyframes popBounce {
    0%   { transform: scale(0.96); }
    40%  { transform: scale(1.2) rotate(-3deg); }
    60%  { transform: scale(1.15) rotate(2deg); }
    80%  { transform: scale(1.05) rotate(-1deg); }
    100% { transform: scale(1) rotate(0deg); }
  }

  /* Sparkle burst on press */
  .sparkle-container {
    position: absolute;
    inset: 0;
    pointer-events: none;
    overflow: visible;
  }

  .sparkle {
    position: absolute;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    top: 50%;
    left: 50%;
    opacity: 0;
  }

  .sparkle.go {
    animation: sparkBurst 0.6s ease-out forwards;
  }

  @keyframes sparkBurst {
    0%   { opacity: 1; transform: translate(-50%, -50%) translate(var(--dx), var(--dy)) scale(0); }
    50%  { opacity: 1; transform: translate(-50%, -50%) translate(calc(var(--dx) * 3), calc(var(--dy) * 3)) scale(1); }
    100% { opacity: 0; transform: translate(-50%, -50%) translate(calc(var(--dx) * 5), calc(var(--dy) * 5)) scale(0); }
  }

  /* Big letter display overlay */
  .big-letter-overlay {
    position: fixed;
    inset: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    opacity: 0;
  }

  .big-letter-overlay.show {
    animation: bigLetterAnim 1s ease-out forwards;
  }

  .big-letter-overlay .big-char {
    font-family: 'Nunito', sans-serif;
    font-weight: 900;
    font-size: clamp(8rem, 30vw, 16rem);
    color: var(--letter-color);
    text-shadow: 0 8px 30px rgba(0,0,0,0.1);
    filter: drop-shadow(0 0 40px var(--letter-color));
  }

  @keyframes bigLetterAnim {
    0%   { opacity: 0; transform: scale(0.3); }
    30%  { opacity: 1; transform: scale(1.1); }
    60%  { opacity: 1; transform: scale(1); }
    100% { opacity: 0; transform: scale(1.4); }
  }

  /* Footer hint */
  .hint {
    text-align: center;
    padding: 16px 20px 32px;
    color: #BEB4D9;
    font-size: 0.85rem;
    font-weight: 600;
    position: relative;
    z-index: 2;
  }

  .hint span {
    display: inline-block;
    animation: bounce 2s infinite ease-in-out;
  }

  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-4px); }
  }

  /* Ad banner at bottom */
  .ad-banner {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 50;
    background: #F0EBF8;
    border-top: 1px solid #E0D8F0;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 60px;
    box-shadow: 0 -2px 12px rgba(45, 27, 105, 0.08);
  }

  .ad-banner .ad-placeholder {
    font-family: 'Baloo 2', cursive;
    font-size: 0.8rem;
    color: #A89CC8;
    letter-spacing: 0.5px;
    padding: 8px 20px;
    border: 1px dashed #C8BDE8;
    border-radius: 8px;
    background: rgba(255,255,255,0.5);
  }
</style>
</head>
<body>

<div class="bg-shapes">
  <span></span><span></span><span></span><span></span><span></span>
</div>

<header>
  <h1><span class="rainbow">ABC Fun!</span></h1>
  <p>Tap a letter to hear its sound ðŸŽµ</p>
</header>

<div class="grid-container">
  <div class="letter-grid" id="letterGrid"></div>
</div>

<div class="hint"><span>ðŸ‘† Tap any letter!</span></div>

<div class="big-letter-overlay" id="bigLetterOverlay">
  <div class="big-char" id="bigChar"></div>
</div>

<!-- AdMob Banner Ad -->
<!-- PRODUCTION: Replace with actual AdMob ad unit via Capacitor AdMob plugin -->
<!-- Test Ad Unit ID: ca-app-pub-3940256099942544/6300978111 -->
<div class="ad-banner" id="adBanner">
  <div class="ad-placeholder">
    ðŸ“¢ AdMob Banner â€” Replace with Ad Unit ID in production
  </div>
</div>

<script>
  // ========== REGISTER SERVICE WORKER ==========
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/sw.js')
        .then((reg) => console.log('SW registered:', reg.scope))
        .catch((err) => console.log('SW registration failed:', err));
    });
  }

  // ========== APP LOGIC ==========
  const LETTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
  const hueForIndex = (i) => Math.round((i / 26) * 360);
  const SPARKLE_COLORS = ['#FF6B6B','#FFE66D','#4ECDC4','#A78BFA','#F97316','#EC4899','#22D3EE'];

  const grid = document.getElementById('letterGrid');
  const overlay = document.getElementById('bigLetterOverlay');
  const bigChar = document.getElementById('bigChar');

  // Build letter tiles
  LETTERS.forEach((letter, i) => {
    const btn = document.createElement('button');
    btn.className = 'letter-tile';
    btn.textContent = letter;
    btn.style.setProperty('--hue', hueForIndex(i));
    btn.style.animationDelay = `${i * 35}ms`;
    btn.setAttribute('aria-label', `Letter ${letter}`);

    const sparkleContainer = document.createElement('div');
    sparkleContainer.className = 'sparkle-container';
    btn.appendChild(sparkleContainer);

    btn.addEventListener('click', () => handlePress(letter, i, btn, sparkleContainer));
    btn.addEventListener('touchstart', (e) => {
      e.preventDefault();
      handlePress(letter, i, btn, sparkleContainer);
    }, { passive: false });

    grid.appendChild(btn);
  });

  function handlePress(letter, index, btn, sparkleContainer) {
    speakLetter(letter);

    btn.classList.remove('pop');
    void btn.offsetWidth;
    btn.classList.add('pop');

    createSparkles(sparkleContainer, index);
    showBigLetter(letter, index);
  }

  function speakLetter(letter) {
    if ('speechSynthesis' in window) {
      window.speechSynthesis.cancel();

      const utterance = new SpeechSynthesisUtterance(letter);
      utterance.rate = 0.85;
      utterance.pitch = 1.15;
      utterance.volume = 1;

      const voices = window.speechSynthesis.getVoices();
      const englishVoice = voices.find(v => v.lang.startsWith('en') && v.name.includes('Female'))
        || voices.find(v => v.lang.startsWith('en'))
        || voices[0];
      if (englishVoice) utterance.voice = englishVoice;

      window.speechSynthesis.speak(utterance);
    }
  }

  function createSparkles(container, index) {
    container.innerHTML = '';
    for (let i = 0; i < 8; i++) {
      const s = document.createElement('div');
      s.className = 'sparkle';
      const angle = (i / 8) * Math.PI * 2;
      const dist = 12 + Math.random() * 8;
      s.style.setProperty('--dx', `${Math.cos(angle) * dist}px`);
      s.style.setProperty('--dy', `${Math.sin(angle) * dist}px`);
      s.style.background = SPARKLE_COLORS[Math.floor(Math.random() * SPARKLE_COLORS.length)];
      container.appendChild(s);
      requestAnimationFrame(() => s.classList.add('go'));
    }
    setTimeout(() => container.innerHTML = '', 700);
  }

  function showBigLetter(letter, index) {
    const hue = hueForIndex(index);
    bigChar.textContent = letter;
    bigChar.style.setProperty('--letter-color', `hsl(${hue}, 70%, 50%)`);
    overlay.classList.remove('show');
    void overlay.offsetWidth;
    overlay.classList.add('show');
    setTimeout(() => overlay.classList.remove('show'), 1050);
  }

  // Preload voices
  if ('speechSynthesis' in window) {
    window.speechSynthesis.getVoices();
    window.speechSynthesis.onvoiceschanged = () => window.speechSynthesis.getVoices();
  }
</script>

</body>
</html>
